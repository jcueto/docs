(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{358:function(t,e,s){"use strict";s.r(e);var a=s(43),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"oasis-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#oasis-service"}},[t._v("#")]),t._v(" oasis.Service")]),t._v(" "),s("p",[s("code",[t._v("oasis.Service")]),t._v(" objects represent deployed services running on the Oasis cloud.")]),t._v(" "),s("h2",{attrs:{id:"constructor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#constructor"}},[t._v("#")]),t._v(" constructor")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("oasis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Service")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("idl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" address "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"parameters"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#parameters"}},[t._v("#")]),t._v(" Parameters")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("idl")]),t._v(" - "),s("code",[t._v("Idl")]),t._v(": The json idl defining the service interface")]),t._v(" "),s("li",[s("code",[t._v("address")]),t._v(" - "),s("code",[t._v("string | Uint8Array")]),t._v(": The address of the service.")]),t._v(" "),s("li",[s("code",[t._v("options")]),t._v(" - "),s("code",[t._v("Object")]),t._v(" (optional):")])]),t._v(" "),s("h3",{attrs:{id:"options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#options"}},[t._v("#")]),t._v(" options")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("gateway")]),t._v(" - "),s("a",{attrs:{href:"./gateways#OasisGateway"}},[t._v("OasisGateway")]),t._v(" (optional): The client backend to communicate with an oasis gateway")]),t._v(" "),s("li",[s("code",[t._v("db")]),t._v(" - "),s("code",[t._v("Db")]),t._v(" (optional): The persistent storage interface for the client's key manager.")])]),t._v(" "),s("h3",{attrs:{id:"returns"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#returns"}},[t._v("#")]),t._v(" Returns")]),t._v(" "),s("p",[s("code",[t._v("Service")]),t._v(": A service object with all rpc endpoints attached.")]),t._v(" "),s("h2",{attrs:{id:"at"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#at"}},[t._v("#")]),t._v(" at")]),t._v(" "),s("p",[t._v("A more convenient api to attach to a previously deployed service is the "),s("code",[t._v("Service.at")]),t._v(" method, which will fetch the on-chain code and extract the idl automatically.")]),t._v(" "),s("p",[t._v("Note: this method should only be with oasis-rs services.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" oasis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("at")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("address "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"parameters-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#parameters-2"}},[t._v("#")]),t._v(" Parameters")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("address")]),t._v(" - "),s("code",[t._v("string | Unit8Array")]),t._v(": The address of the service to connect to.")]),t._v(" "),s("li",[s("code",[t._v("options")]),t._v(" - "),s("code",[t._v("Object")]),t._v(" (optional): The service deploy options. See above.")])]),t._v(" "),s("h3",{attrs:{id:"returns-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#returns-2"}},[t._v("#")]),t._v(" Returns")]),t._v(" "),s("p",[s("code",[t._v("Promise<Service>")]),t._v(": A promise resolving to a service object with all rpc endpoints attached.")]),t._v(" "),s("h2",{attrs:{id:"rpc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rpc"}},[t._v("#")]),t._v(" rpc")]),t._v(" "),s("p",[t._v("To make rpc requests to a service, invoke the rpc directly on the service object.\nFor example,")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Deployed service address.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" address "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Connects to the remote service.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" service "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" Service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("at")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("address"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Service specific rpc parameter.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" argument "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'this is an argument to a Service rpc'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RpcOptions.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" gasLimit"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0xe79732'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Makes an rpc request to `myMethod` and returns the result.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" returnValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("myMethod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("argument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("The client will ensure all Service api methods are camelCase, as is idiomatic JavaScript, even if your on-chain service uses snake_case, as is idiomatic Rust.")])]),t._v(" "),s("p",[t._v("The positional arguments for a given rpc should be passed directly into the method.\nIn addition, one can "),s("strong",[t._v("optionally")]),t._v(" specify "),s("code",[t._v("RpcOptions")]),t._v(".\nWhen used, these options must be the last argument given to a method.")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("When making RPCs to "),s("strong",[t._v("confidential")]),t._v(" services, one "),s("strong",[t._v("must")]),t._v(" specify the "),s("code",[t._v("gasLimit")]),t._v(" option.\nThe client can't estimiate the gas limit when state is confidential.")])]),t._v(" "),s("p",[t._v("A Service's method call returns only after the transaction has been finalized by the Oasis network.")]),t._v(" "),s("h3",{attrs:{id:"rpcoptions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rpcoptions"}},[t._v("#")]),t._v(" RpcOptions")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("gasLimit")]),t._v(" - "),s("code",[t._v("string")]),t._v(" | "),s("code",[t._v("number")]),t._v(" (optional): Gas limit to use for the transaction.")]),t._v(" "),s("li",[s("code",[t._v("value")]),t._v(" - "),s("code",[t._v("string")]),t._v(" | "),s("code",[t._v("number")]),t._v(" (optional): Value to send in the transaction.")]),t._v(" "),s("li",[s("code",[t._v("aad")]),t._v(" - "),s("code",[t._v("string")]),t._v(" (optional): Additional authenticated data exposed to the confidential runtime.")])]),t._v(" "),s("h2",{attrs:{id:"addeventlistener"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#addeventlistener"}},[t._v("#")]),t._v(" addEventListener")]),t._v(" "),s("p",[t._v("To listen to events emitted by the service, use the "),s("code",[t._v("addEventListener")]),t._v(" method.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("listener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Received the event, '")]),t._v(" event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("An event is emitted only after the block containing it has been finalized by the Oasis network.")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("In the same way rpc method names are camelCase, event object keys are camelCase, even if the corresponding service is snake_case.")])]),t._v(" "),s("h3",{attrs:{id:"parameters-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#parameters-3"}},[t._v("#")]),t._v(" Parameters")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("event")]),t._v(" - "),s("code",[t._v("String")]),t._v(": The name of the event.")]),t._v(" "),s("li",[s("code",[t._v("listener")]),t._v(" - "),s("code",[t._v("Listener")]),t._v(": A function taking a single event as a parameter.")])]),t._v(" "),s("h2",{attrs:{id:"removeeventlistener"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#removeeventlistener"}},[t._v("#")]),t._v(" removeEventListener")]),t._v(" "),s("p",[t._v("To stop listening to events emitted by the service, use the "),s("code",[t._v("removeEventListener")]),t._v(" method.\nIt's suggested to use this method to properly cleanup gateway subscriptions that result from creating event listeners.")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" listener"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"parameters-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#parameters-4"}},[t._v("#")]),t._v(" Parameters")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("event")]),t._v(" - "),s("code",[t._v("String")]),t._v(": The name of the event.")]),t._v(" "),s("li",[s("code",[t._v("listener")]),t._v(" - "),s("code",[t._v("Listener")]),t._v(": The listener function previously given to "),s("code",[t._v("addEventListener")]),t._v(".")])])])}),[],!1,null,null,null);e.default=n.exports}}]);